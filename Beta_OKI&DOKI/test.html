<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Hi Land !</title>
    <script src="//cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.js">
    </script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>

<body>
    <script type="text/javascript">

        var keyA;
        var keyZ;
        var keyE
        var player;
        
        var cursors; // variable pour le cursors
        var gameOver
        var pologlace = true
        var changecaract = false
        var score=0
        var scoretext
        var PV=2
        var protectionglace = 0
        var scoreText
        var graphics
        var doublejump = 0
        var repousseright = false
        var repousseleft = false
        var attaque = false
        var lanceattack = true
        var turnprojo = false
        var tombe1 = false
        var safe = false
        var tempsdegats = false





                        class test extends Phaser.Scene {


                constructor() {

                    super("test")
                }




                preload() {
                        // chargement du personnage
                    this.load.spritesheet("dude", "assets/Polo.png", {
                        frameWidth: 32,
                        frameHeight: 64
                    });

                    this.load.spritesheet("dude2", "assets/Pologlace.png", {
                        frameWidth: 32,
                        frameHeight: 64
                    });

                    this.load.spritesheet("dudeglace", "assets/Pologlace.png", {
                        frameWidth: 32,
                        frameHeight: 64
                    });



                    this.load.spritesheet("bitcoin", "assets/bitcoin.png", {
                        frameWidth: 32,
                        frameHeight: 32,
                    });

                    this.load.spritesheet("dossier", "assets/dossier.png", {
                        frameWidth: 32,
                        frameHeight: 32,
                    });


                    this.load.spritesheet("click", "assets/click.png", {
                        frameWidth: 32,
                        frameHeight: 32,
                    });
                    this.load.spritesheet("porte", "assets/portes.png", {
                        frameWidth: 64,
                        frameHeight: 64,
                    });

                    this.load.spritesheet("zoneattack", "assets/attack.png", {
                        frameWidth: 64,
                        frameHeight: 64,
                    });

                    this.load.spritesheet("projo", "assets/projo.png", {
                        frameWidth: 370,
                        frameHeight: 109,
                    });

                    this.load.spritesheet("obscur", "assets/obscur.png", {
                        frameWidth: 371,
                        frameHeight: 207,
                    });
                    // chargement tuiles de jeu
                    this.load.image("Phaser_Tileset", "assets/Tileset.png");

                    // chargement de la carte
                    this.load.tilemapTiledJSON("carte", "assets/Monniveau.json");

                    this.load.image("interfacefenetre", "assets/fenetre clean.png" );

                    this.load.image("interfacenormal", "assets/interface full.png" );

                    this.load.image("interfacedegats", "assets/interface degats.png" );
                    this.load.spritesheet("virus", "assets/mobile.png", {
                        frameWidth: 32,
                        frameHeight: 32,
                    });
                    this.load.image('nuit', 'assets/nuit.png');
                    

                }


                create() {
                        // chargement de la carte du niveau
                        const carteDuNiveau = this.add.tilemap("carte");
                        // chargement du jeu de tuiles
                        const tileset = carteDuNiveau.addTilesetImage(
                        "Placeholder",
                        "Phaser_Tileset"
                        );


                        // chargement du calque "calque_backgroung"
                        const deco = carteDuNiveau.createStaticLayer(
                        "Background",
                        tileset
                        );



                        // chargement du calque "calque_plateformes""
                        const plateformes = carteDuNiveau.createStaticLayer(
                        "Plateformes",
                        tileset
                        );

                        // chargement du calque "calque_plateformes""
                        const grimpette = carteDuNiveau.createStaticLayer(
                        "grimpette",
                        tileset
                        );



                        //affichage de l'interface
                        this.add.image(120,75, "interfacefenetre").setScrollFactor(0);
                        this.add.image(120,75, "interfacenormal").setScrollFactor(0);
                        //affiche un texte à l’écran, pour le score
                        
                        scoreText=this.add.text(175,100,'0',{fontSize:'32px',fill:'#000'}).setScrollFactor(0);

                        
                        var doublejump = 0
                        

                        // définition des objets solides avec lesquels le personnage va interagir
                        plateformes.setCollisionByProperty({ solide: true });
                        grimpette.setCollisionByProperty({ grimpe: true });

                        // création du personnage de jeu et positionnement
                        player = this.physics.add.sprite(100,1490,"dude");
                        
                        keyA = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A);
                        keyZ = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.Z);

                        // ajout du modèle de collision entre le personnage et les plates-formes et les ennemis et les piques
                        this.physics.add.collider(player, plateformes);
                        this.physics.add.collider(player, grimpette,this.escalade);
                        

                        gameOver = false;



                        // ajout du modèle de collision entre le personnage et le monde
                        player.setCollideWorldBounds(true);

                        
                        

                        // animation du perso pour tourner à gauche
                        this.anims.create({
                        key: "left",
                        frames: this.anims.generateFrameNumbers("dude", { start: 0, end: 3 }),
                        frameRate: 10,
                        repeat: -1
                        });

                        // animation du perso lorsque le personnage n'avance pas
                        this.anims.create({
                        key: "turn",
                        frames: [{ key: "dude", frame: 4 }],
                        frameRate: 20
                        });

                        // animation du perso pour tourner à droite
                        this.anims.create({
                        key: "right",
                        frames: this.anims.generateFrameNumbers("dude", { start: 5, end: 8 }),
                        frameRate: 10,
                        repeat: -1
                        });


                        //animation des portes
                        this.anims.create({
                        key: "portesoleilouverte",
                        frames: this.anims.generateFrameNumbers("porte", { start: 1, end: 1 }),
                        frameRate: 10,
                        });
                        this.anims.create({
                        key: "portesoleilfermee",
                        frames: this.anims.generateFrameNumbers("porte", { start: 0, end: 0 }),
                        frameRate: 10,
                        });

                        this.anims.create({
                        key: "porteluneouverte",
                        frames: this.anims.generateFrameNumbers("porte", { start: 3}),
                        frameRate: 10,
                        
                        });
                        this.anims.create({
                        key: "portelunefermee",
                        frames: this.anims.generateFrameNumbers("porte", { start: 1, end: 1 }),
                        frameRate: 10,
                        });


                        this.portesoleil = this.physics.add.sprite(200,1503,"porte");
                        this.portesoleil.setImmovable();
                        this.portesoleil.body.setAllowGravity(false)
                        this.physics.add.collider(player, this.portesoleil);

                        this.portelune = this.physics.add.sprite(300,1503,"porte");
                        this.portelune.setImmovable();
                        this.portelune.body.setAllowGravity(false)
                        this.physics.add.collider(player, this.portelune);

                        this.zoneattack = this.physics.add.sprite(100,1400,"zoneattack");
                        this.zoneattack.setCircle(48);
                        this.zoneattack.setImmovable();
                        this.zoneattack.body.setAllowGravity(false)
                        
                        










                        this.anims.create({
                        key: "leftg",
                        frames: this.anims.generateFrameNumbers("dude", { start: 9, end:12 }),
                        frameRate: 10,
                        repeat: -1
                        });

                        // animation du perso lorsque le personnage n'avance pas
                        this.anims.create({
                        key: "turng",
                        frames: [{ key: "dude", frame: 13 }],
                        frameRate: 20
                        });

                        // animation du perso pour tourner à droite
                        this.anims.create({
                        key: "rightg",
                        frames: this.anims.generateFrameNumbers("dude", { start: 15, end: 18 }),
                        frameRate: 10,
                        repeat: -1
                        });

                        





                        // création d'un écouteur sur le cursors
                        cursors = this.input.keyboard.createCursorKeys();

                        // redimentionnement du monde avec les dimensions calculées via tiled
                        this.physics.world.setBounds(0, 0, 9248, 3264);
                        //  ajout du champs de la caméra de taille identique à celle du monde
                        this.cameras.main.setBounds(0, 0, 9248, 3264);
                        // ancrage de la caméra sur le joueur
                        this.cameras.main.startFollow(player); 


                        this.anims.create({
                        key: 'virusactif',
                        frames: this.anims.generateFrameNumbers('virus', { start: 0, end: 1 }),
                        frameRate: 10,
                        repeat: -1
                        });

                        var startPoint = new Phaser.Math.Vector2(800, 630);
                        var controlPoint1 = new Phaser.Math.Vector2(1000, 630);
                        var controlPoint2 = new Phaser.Math.Vector2(1250, 630);
                        var endPoint = new Phaser.Math.Vector2(1700, 630);

                        var curve = new Phaser.Curves.CubicBezier(startPoint, controlPoint1, controlPoint2, endPoint);

                        var graphics = this.add.graphics();



                        this.followvirus = this.add.follower(curve, 500, 1500, 'virus').setInteractive();
                        this.physics.add.existing(this.followvirus);
                        this.followvirus.body.setAllowGravity(false)
                        this.followvirus.anims.play('virusactif', true)
                        var shape = new Phaser.Geom.Circle(96,96,96);
                        this.followvirus.setInteractive(shape, Phaser.Geom.Circle.Contains);
                        this.followvirus.setSize(32, 32);
                        this.physics.add.collider(player, this.followvirus,this.degats,null,this);
                        this.physics.add.collider(this.zoneattack, this.followvirus,this.degatsennemi,null,this);
                        

                        this.followvirus.startFollow({
                            duration: 5000,
                            yoyo: true,
                            ease: 'Sine.easeInOut',
                            repeat : -1
                        });


                        this.nuit = this.add.sprite(550, 475, 'nuit').setScrollFactor(0);
                        this.nuit.alpha = 0.8;
                        this.nuit.visible = false;

                        //ajout popcorn
                        this.bitcoin = this.physics.add.sprite(215, 1510, "bitcoin");
                        this.bitcoin.body.allowGravity = false
                        this.physics.add.collider(player, this.bitcoin, this.collectpop, null, this);

                        this.projo = this.physics.add.sprite(400,1300,"projo");
                        this.projo.setImmovable();
                        this.projo.body.setAllowGravity(false);
                        this.projo.setSize(50, 370);
                        this.projo.setOffset(30,0);
                        this.physics.add.collider(player, this.projo,this.degats,null,this);
                        

                        this.obscur = this.physics.add.sprite(700,1450,"obscur");
                        this.obscur.setImmovable();
                        this.obscur.body.setAllowGravity(false);
                        this.obscur.setOffset(0,0);
                        this.physics.add.collider(player, this.obscur,this.degats,null,this);


                        


                }

                update() {



                    if(turnprojo == true){
                        this.projo.rotation += 0.01;
                        this.projo.angle +=0.01;
                        setTimeout(() => {
                        turnprojo = false
                                    }, 600);
                    }

                    if(turnprojo == false){
                        this.projo.rotation -= 0.01;
                        setTimeout(() => {
                        turnprojo = true
                                    }, 600);
                    }


                        
                        scoreText.setText(PV)
                        console.log(pologlace)

                        

                    if (keyA.isDown && changecaract == false) {
                        pologlace = true
                        setTimeout(() => {
                        changecaract = true
                                    }, 400);
                                
                    
                    }
                    else if (keyA.isDown && changecaract == true) {
                        pologlace = false
                        setTimeout(() => {
                        changecaract = false
                                    }, 400);
                                

                    }

                    if (pologlace == true){
                        this.nuit.visible = true;
                            if (cursors.left.isDown) {
                            player.setVelocityX(-220);
                            player.anims.play("leftg", true);

                            // à droite
                        } else if (cursors.right.isDown) {
                            player.setVelocityX(220);
                            player.anims.play("rightg", true);
                        }
                        // immoobile
                        else {
                            player.setVelocityX(0);
                            player.anims.play("turng");
                        }
                        // en saut (important : blocked doown au lieu de tuoching down)
                        if (cursors.up.isDown && player.body.blocked.down) {
                            player.setVelocityY(-50);
                        }
                        if ((cursors.up.isDown && player.body.blocked.down)){
                                //si touche haut appuyée ET que le perso touche le sol
                                player.setVelocityY(-300); //alors vitesse verticale négative
                        }
                        if(repousseright == true){
                                player.setVelocityX(-100)
                                console.log("repousser !")
                            }

                        //changement etat des portes
                        

                        this.portelune.anims.play('portelunefermee', true)
                        this.portelune.setOffset(0,-1000);

                        this.portesoleil.anims.play('portesoleilfermee', true)
                        this.portesoleil.setOffset(0,0);

                        //comportement hotbox des projo
                        this.projo.setOffset(30,0);
                        this.obscur.setOffset(-5000,0);
                    }
                     
                    
                    
                    
                    
                    
                    
                        else if (pologlace == false){
                            this.nuit.visible = false;
                        // a gauche
                            if (cursors.left.isDown) {
                            player.setVelocityX(-230);
                            player.anims.play("left", true);

                            // à droite
                            } else if (cursors.right.isDown) {
                            player.setVelocityX(230);
                            player.anims.play("right", true);
                            }
                            // immoobile
                            else {
                            player.setVelocityX(0);
                            player.anims.play("turn");
                            }
                            //lorsdupremier saut, possibilité de double jump
                            if ((cursors.up.isDown && player.body.blocked.down)){
                                player.setVelocityY(-300);
                                doublejump = 0
                                setTimeout(() => {
                                    doublejump = 1
                                
                                    }, 300);
                            }
                            //Doublejump effectuer, un seul disponible après utilisation !
                            if ((cursors.up.isDown && doublejump == 1)){
                                        player.setVelocityY(-300);
                                        doublejump = 0
                            }
                            if ((player.body.blocked.down)){
                                        doublejump = 1
                            }


                            if (keyZ.isDown && lanceattack == true) {
                                attaque = true
                                lanceattack = false
                                setTimeout(() => {
                                    attaque = false
                                    this.zoneattack.y = -5000
                                    this.zoneattack.x = -5000
                                }, 200);
                                setTimeout(() => {
                                    lanceattack = true
                                }, 700);
                            }
                            if (attaque == true) {
                                this.zoneattack.y = player.y - 29
                                this.zoneattack.x = player.x - 29
                            }
                            if(repousseright == true){
                                player.setVelocityX(-100)
                                console.log("repousser !")
                            }







                            
                            //changement etat des portes
                            this.portesoleil.anims.play('portesoleilouverte', true)
                            this.portesoleil.setOffset(0,-1000);
                            

                            this.portelune.anims.play('porteluneouverte', true)
                            this.portelune.setOffset(0,0);
                            if(repousseright == true){
                                player.setVelocityX(-100)
                                console.log("repousser !")
                            }
                            //comportement hotbox des projo
                            this.projo.setOffset(-5000,0);
                            this.obscur.setOffset(0,0);
                            
                            
                        }
                    

                        player.body.setAllowGravity(true)
                    if (gameOver){return;}

                    



                            



                    
                }

                    

                    degats() {
                    

                        if (PV >= 1){
                            cursors.right.reset();
                            cursors.left.reset();
                            cursors.up.reset();
                            cursors.down.reset();
                            cursors.right.enabled = false;
                            cursors.left.enabled = false;
                            cursors.up.enabled = false;
                            cursors.down.enabled = false;
                            player.setVelocityY(-350)
                            repousseright = true
                            player.alpha = 0.5
                            this.serolReset = this.time.addEvent({
                            delay: 4000,
                            callback: ()=>{
                                player.alpha = 1;
                                PV = 0;
                            },
                            loop: false
                            })
                        this.serolReset = this.time.addEvent({
                            delay: 1700,
                            callback: ()=>{
                                repousseright = false
                                cursors.right.enabled = true;
                                cursors.left.enabled = true;
                                cursors.up.enabled = true;
                                cursors.down.enabled = true;
                            },
                            loop: false
                        })
                        console.log("aie")
                        }
                    
                        

                        if (PV == 0){
                            this.physics.pause();
                            player.setTint(0xff0000);
                            player.anims.play('turn');
                            gameOver = true;
                            console.log("aie2")
                        }
                        
                    
                    }

                    degatsennemi() {
                        this.followvirus.destroy()
                    

                    }

                    collectpop(){
                    PV += 1; //augmente le score de 1
                    this.bitcoin.disableBody(true, true); // l’étoile disparaît
                    
                    }

                    escalade() {
                        if (pologlace == true){
                            player.body.setAllowGravity(false)
                            player.setVelocityX(0);
                            player.setVelocityY(0);
                            if (cursors.up.isDown) {
                            player.setVelocityY(-100);
                            }
                            if ((cursors.down.isDown)){
                                    //si touche haut appuyée ET que le perso touche le sol
                                    player.setVelocityY(100); //alors vitesse verticale négative
                            }

                        }

                    }

                }

















                    class Studio extends Phaser.Scene {


            constructor() {

                super("Studio")
            }




            preload() {
                    // chargement du personnage
                this.load.spritesheet("dude", "assets/Polo.png", {
                    frameWidth: 32,
                    frameHeight: 64
                });

                this.load.spritesheet("dude2", "assets/Pologlace.png", {
                    frameWidth: 32,
                    frameHeight: 64
                });

                this.load.spritesheet("dudeglace", "assets/Pologlace.png", {
                    frameWidth: 32,
                    frameHeight: 64
                });



                this.load.spritesheet("bitcoin", "assets/bitcoin.png", {
                    frameWidth: 32,
                    frameHeight: 32,
                });

                this.load.spritesheet("popcorn", "assets/popcorn.png", {
                    frameWidth: 32,
                    frameHeight: 48,
                });


                this.load.spritesheet("click", "assets/click.png", {
                    frameWidth: 32,
                    frameHeight: 32,
                });
                this.load.spritesheet("porte", "assets/portes.png", {
                    frameWidth: 64,
                    frameHeight: 64,
                });

                this.load.spritesheet("nacelle", "assets/nacellemobile.png", {
                    frameWidth: 96,
                    frameHeight: 64,
                });

                this.load.spritesheet("zoneattack", "assets/attack.png", {
                    frameWidth: 64,
                    frameHeight: 64,
                });

                this.load.spritesheet("ennemivol", "assets/ennemivol.png", {
                    frameWidth: 64,
                    frameHeight: 32,
                });

                this.load.spritesheet("ennemiterre", "assets/ennemiterre.png", {
                    frameWidth: 32,
                    frameHeight: 64,
                });

                this.load.spritesheet("miniobscur", "assets/miniobscur.png", {
                    frameWidth: 32,
                    frameHeight: 32,
                });

                this.load.spritesheet("shine", "assets/shine.png", {
                    frameWidth: 32,
                    frameHeight: 32,
                });

                this.load.spritesheet("safe", "assets/safe.png", {
                    frameWidth: 32,
                    frameHeight: 32,
                });

                this.load.image("vuedoki", "assets/vuedoki.png" );


                // chargement tuiles de jeu
                this.load.image("Phaser_Tileset", "assets/Placedoki.png");

                // chargement de la carte
                this.load.tilemapTiledJSON("carte", "assets/Studio.json");

                this.load.image("interfacefenetre", "assets/fenetre clean.png" );

                this.load.image("interfacenormal", "assets/interface full.png" );

                this.load.image("interfacedegats", "assets/interface degats.png" );
                this.load.spritesheet("virus", "assets/mobile.png", {
                    frameWidth: 32,
                    frameHeight: 32,
                });
                this.load.image('nuit', 'assets/nuit.png');
                this.load.spritesheet("projo", "assets/projo.png", {
                        frameWidth: 370,
                        frameHeight: 109,
                    });

                    this.load.spritesheet("projohorizon", "assets/projohorizon.png", {
                        frameWidth: 109,
                        frameHeight: 370,
                    });

                    this.load.spritesheet("obscur", "assets/obscur.png", {
                        frameWidth: 371,
                        frameHeight: 207,
                    });

                    this.load.spritesheet("chaise", "assets/chaise.png", {
                        frameWidth: 32,
                        frameHeight: 48,
                    });
                    
                

            }


            create() {
                    this.map = this.add.tilemap("carte");
                    // chargement de la carte du niveau
                    const carteDuNiveau = this.add.tilemap("carte");
                    // chargement du jeu de tuiles
                    const tileset = carteDuNiveau.addTilesetImage(
                    "Placedoki",
                    "Phaser_Tileset"
                    );

                    const fond = carteDuNiveau.createStaticLayer(
                    "fond",
                    tileset
                    );

                    // chargement du calque "calque_backgroung"
                    const deco = carteDuNiveau.createStaticLayer(
                    "deco",
                    tileset
                    );



                    // chargement du calque "calque_plateformes""
                    const sol = carteDuNiveau.createStaticLayer(
                    "sol",
                    tileset
                    );

                    // chargement du calque "calque_plateformes""
                    const grimpette = carteDuNiveau.createStaticLayer(
                    "grimpette",
                    tileset
                    );

                    this.popcorns = this.map.createLayer(
                        "popcornss",
                        this.tileset
                    );

                    this.obscurite = this.map.createLayer(
                        "obscurite",
                        this.tileset
                    );

                    this.shine = this.map.createLayer(
                        "shine",
                        this.tileset
                    );

                    this.projecteurs = this.map.createLayer(
                        "projecteurs",
                        this.tileset
                    );

                    this.projecteurshorizon = this.map.createLayer(
                        "projecteurshorizon",
                        this.tileset
                    );

                    this.switchplace = this.map.createLayer(
                        "safespot",
                        this.tileset
                    );



                    player = this.physics.add.sprite(3600,3000,"dude");
                    //player = this.physics.add.sprite(5930,1900,"dude");




                    this.grppopcorns = this.physics.add.group({ immovable: true, allowGravity: false })
                    this.pop = this.map.getObjectLayer("popcornss");
                    this.pop.objects.forEach(coord => {
                        this.grppopcorns.create(coord.x, coord.y - 32, "popcorn");
                    });

                    this.grppobscur = this.physics.add.group({ immovable: true, allowGravity: false })
                    this.ombre = this.map.getObjectLayer("obscurite");
                    this.ombre.objects.forEach(coord => {
                        this.grppobscur.create(coord.x + 16, coord.y - 16, "miniobscur");
                    });

                    this.grpshine = this.physics.add.group({ immovable: true, allowGravity: false })
                    this.brillant = this.map.getObjectLayer("shine");
                    this.brillant.objects.forEach(coord => {
                        this.grpshine.create(coord.x + 16, coord.y - 16, "shine");
                    });

                    this.grpsafe = this.physics.add.group({ immovable: true, allowGravity: false })
                    this.safespot = this.map.getObjectLayer("safespot");
                    this.safespot.objects.forEach(coord => {
                        this.grpsafe.create(coord.x + 16, coord.y - 16, "safe");
                    });

                   
                    
                    

                    //affichage de l'interface
                    this.add.image(120,75, "interfacefenetre").setScrollFactor(0);
                    this.add.image(120,75, "interfacenormal").setScrollFactor(0);
                    //affiche un texte à l’écran, pour le score
                    
                    scoreText=this.add.text(175,100,'0',{fontSize:'32px',fill:'#000'}).setScrollFactor(0);

                    
                    var doublejump = 0
                    

                    // définition des objets solides avec lesquels le personnage va interagir
                    sol.setCollisionByProperty({ solide: true });
                    grimpette.setCollisionByProperty({ grimpe: true });

                    //nacceles
                    
                    
                   

                    // création du personnage de jeu et positionnement
                    
                    
                    keyA = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A);
                    keyZ = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.Z);

                    // ajout du modèle de collision entre le personnage et les plates-formes et les ennemis et les piques
                    this.physics.add.collider(player, sol);
                    this.physics.add.collider(player, grimpette,this.escalade);
                    this.physics.add.overlap(player, this.grppobscur, this.degats, null, this);
                    this.physics.add.overlap(player, this.grpshine, this.degats, null, this);
                    this.physics.add.overlap(player, this.grpsafe, this.switch, null, this);
                    
                    
                    
                    
    
                    gameOver = false;



                    // ajout du modèle de collision entre le personnage et le monde
                    player.setCollideWorldBounds(true);

                    
                    

                    // animation du perso pour tourner à gauche
                    this.anims.create({
                    key: "left",
                    frames: this.anims.generateFrameNumbers("dude", { start: 0, end: 3 }),
                    frameRate: 10,
                    repeat: -1
                    });

                    // animation du perso lorsque le personnage n'avance pas
                    this.anims.create({
                    key: "turn",
                    frames: [{ key: "dude", frame: 4 }],
                    frameRate: 20
                    });

                    // animation du perso pour tourner à droite
                    this.anims.create({
                    key: "right",
                    frames: this.anims.generateFrameNumbers("dude", { start: 5, end: 8 }),
                    frameRate: 10,
                    repeat: -1
                    });


                    //animation des portes
                    this.anims.create({
                    key: "portesoleilouverte",
                    frames: this.anims.generateFrameNumbers("porte", { start: 1, end: 1 }),
                    frameRate: 10,
                    });
                    this.anims.create({
                    key: "portesoleilfermee",
                    frames: this.anims.generateFrameNumbers("porte", { start: 0, end: 0 }),
                    frameRate: 10,
                    });

                    this.anims.create({
                    key: "porteluneouverte",
                    frames: this.anims.generateFrameNumbers("porte", { start: 3}),
                    frameRate: 10,
                    
                    });
                    this.anims.create({
                    key: "portelunefermee",
                    frames: this.anims.generateFrameNumbers("porte", { start: 1, end: 1 }),
                    frameRate: 10,
                    });

                    this.anims.create({
                    key: "nacelleallumee",
                    frames: this.anims.generateFrameNumbers("nacelle", { start: 0, end: 5 }),
                    frameRate: 10,
                    repeat: -1
                    });
                    this.anims.create({
                    key: "popcorn",
                    frames: this.anims.generateFrameNumbers("popcorn", { start: 0, end: 7 }),
                    frameRate: 10,
                    repeat: -1
                    });

                    this.anims.create({
                    key: "chaise",
                    frames: this.anims.generateFrameNumbers("chaise", { start: 0, end: 9 }),
                    frameRate: 20,
                    repeat: -1
                    });


                    this.portesoleil = this.physics.add.sprite(100,100,"porte").setScale(1.55);
                    this.portesoleil.setImmovable();
                    this.portesoleil.body.setAllowGravity(false)
                    this.physics.add.collider(player, this.portesoleil);

                    this.portelune = this.physics.add.sprite(5358,1263,"porte").setScale(1.46);
                    this.portelune.setImmovable();
                    this.portelune.body.setAllowGravity(false)
                    this.physics.add.collider(player, this.portelune);

                    this.zoneattack = this.physics.add.sprite(100,1400,"zoneattack");
                    this.zoneattack.setCircle(48);
                    this.zoneattack.setImmovable();
                    this.zoneattack.body.setAllowGravity(false)
                    
                    

                    //nacelles
                    this.nacelle1 = this.physics.add.sprite(5660,2100,"nacelle");
                    this.nacelle1.setImmovable();
                    this.nacelle1.body.setAllowGravity(false);
                    this.physics.add.collider(player,this.nacelle1);
                    this.nacelle1.anims.play('nacelleallumee', true)
                    this.nacelle1.setSize(96, 32);
                    this.nacelle1.setOffset(0,32);

                    this.nacelle2 = this.physics.add.sprite(5900,390,"nacelle");
                    this.nacelle2.setImmovable();
                    this.nacelle2.body.setAllowGravity(false);
                    this.physics.add.collider(player,this.nacelle2);
                    this.nacelle2.anims.play('nacelleallumee', true)
                    this.nacelle2.setSize(96, 32);
                    this.nacelle2.setOffset(0,32);

                    this.nacelle3 = this.physics.add.sprite(7000,780,"nacelle");
                    this.nacelle3.setImmovable();
                    this.nacelle3.body.setAllowGravity(false);
                    this.physics.add.collider(player,this.nacelle3);
                    this.nacelle3.anims.play('nacelleallumee', true)
                    this.nacelle3.setSize(96, 32);
                    this.nacelle3.setOffset(0,32);



                    //popcorn
                    this.popcorn = this.physics.add.sprite(450,2976,"popcorn");
                    this.popcorn.body.setAllowGravity(false)
                    this.physics.add.overlap(player, this.grppopcorns, this.collectpop, null, this);
                    this.popcorn.anims.play('popcorn', true)
                    this.grppopcorns.getChildren().forEach(function (child) {
                        //child.setOffset(5000,32);
                        child.anims.play('popcorn', true)
                    }, this)


                    //ennemivol
                    this.ennemivol = this.physics.add.sprite(4400,1280,"ennemivol");
                    this.physics.add.collider(this.ennemivol, sol);
                    this.ennemivol.body.setAllowGravity(false)
                    this.ennemivol.setImmovable(true);
                    this.physics.add.collider(player,this.ennemivol,this.degats,null,this);

                    this.hitbox = this.physics.add.sprite(4400,1280,"ennemivol");
                    this.hitbox.body.setAllowGravity(false)
                    this.hitbox.setImmovable(true);
                    this.hitbox.setSize(64, 300);
                    this.hitbox.setOffset(0,0);
                    this.physics.add.collider(player,this.hitbox,this.ennemitombe,null,this);



                    this.ennemivol2 = this.physics.add.sprite(5935,885,"ennemivol");
                    this.physics.add.collider(this.ennemivol2, sol);
                    this.ennemivol2.body.setAllowGravity(false)
                    this.ennemivol2.setImmovable(true);
                    this.physics.add.collider(player,this.ennemivol2,this.degats,null,this);

                    this.hitbox2 = this.physics.add.sprite(5935,885,"ennemivol");
                    this.hitbox2.body.setAllowGravity(false)
                    this.hitbox2.setImmovable(true);
                    this.hitbox2.setSize(64, 300);
                    this.hitbox2.setOffset(0,0);
                    this.physics.add.collider(player,this.hitbox2,this.ennemitombe2,null,this);




                    //ennemiterrestres
                    this.ennemiterre = this.physics.add.sprite(5500,2200,"ennemiterre");
                    this.physics.add.collider(this.ennemiterre, sol);
                    this.physics.add.collider(player,this.ennemiterre,this.degats,null,this);
                    this.physics.add.collider( this.ennemiterre,this.zoneattack,this.degatsennemi4,null,this);
                    this.ennemiterre.setImmovable(true);


                    this.ennemiterre2 = this.physics.add.sprite(6350,1100,"ennemiterre");
                    this.physics.add.collider(this.ennemiterre2, sol);
                    this.physics.add.collider(player,this.ennemiterre2,this.degats,null,this);
                    this.physics.add.collider( this.ennemiterre2,this.zoneattack,this.degatsennemi5,null,this);
                    this.ennemiterre2.setImmovable(true);
                    

                    //chaises
                    this.chaise1 = this.physics.add.sprite(5930,2000,"chaise");
                    this.physics.add.collider(this.chaise1, sol);
                    this.chaise1.setImmovable(true);
                    this.chaise1.setSize(32, 32);
                    this.chaise1.setOffset(0,16);
                    this.physics.add.collider(player,this.chaise1,this.bumper1,null,this);

                    this.chaise2 = this.physics.add.sprite(6000,1700,"chaise");
                    this.physics.add.collider(this.chaise2, sol);
                    this.chaise2.setImmovable(true);
                    this.chaise2.setSize(32, 32);
                    this.chaise2.setOffset(0,16);
                    this.physics.add.collider(player,this.chaise2,this.bumper2,null,this);

                    this.chaise3 = this.physics.add.sprite(5870,1400,"chaise");
                    this.physics.add.collider(this.chaise3, sol);
                    this.chaise3.setSize(32, 32);
                    this.chaise3.setOffset(0,16);
                    this.chaise3.setImmovable(true);
                    this.physics.add.collider(player,this.chaise3,this.bumper3,null,this);

                    this.chaise4 = this.physics.add.sprite(5260,1263,"chaise");
                    this.physics.add.collider(this.chaise4, sol);
                    this.chaise4.setSize(32, 32);
                    this.chaise4.setOffset(0,16);
                    this.chaise4.setImmovable(true);
                    this.physics.add.collider(player,this.chaise4,this.bumper4,null,this);

                    this.chaise5 = this.physics.add.sprite(5900,700,"chaise");
                    this.physics.add.collider(this.chaise5, sol);
                    this.chaise5.setSize(32, 32);
                    this.chaise5.setOffset(0,16);
                    this.chaise5.setImmovable(true);
                    this.physics.add.collider(player,this.chaise5,this.bumper5,null,this);

                    this.chaise6 = this.physics.add.sprite(5650,500,"chaise");
                    this.physics.add.collider(this.chaise6, sol);
                    this.chaise6.setSize(32, 32);
                    this.chaise6.setOffset(0,16);
                    this.chaise6.setImmovable(true);
                    this.physics.add.collider(player,this.chaise6,this.bumper6,null,this);

                    this.chaise7 = this.physics.add.sprite(7200,700,"chaise");
                    this.physics.add.collider(this.chaise7, sol);
                    this.chaise7.setImmovable(true);
                    this.chaise7.setSize(32, 32);
                    this.chaise7.setOffset(0,16);
                    this.physics.add.collider(player,this.chaise7,this.bumper7,null,this);


                    this.anims.create({
                    key: "leftg",
                    frames: this.anims.generateFrameNumbers("dude", { start: 9, end:12 }),
                    frameRate: 10,
                    repeat: -1
                    });

                    // animation du perso lorsque le personnage n'avance pas
                    this.anims.create({
                    key: "turng",
                    frames: [{ key: "dude", frame: 13 }],
                    frameRate: 20
                    });

                    // animation du perso pour tourner à droite
                    this.anims.create({
                    key: "rightg",
                    frames: this.anims.generateFrameNumbers("dude", { start: 15, end: 18 }),
                    frameRate: 10,
                    repeat: -1
                    });

                    





                    // création d'un écouteur sur le cursors
                    cursors = this.input.keyboard.createCursorKeys();

                    // redimentionnement du monde avec les dimensions calculées via tiled
                    this.physics.world.setBounds(0, 0, 9999, 3264);
                    //  ajout du champs de la caméra de taille identique à celle du monde
                    this.cameras.main.setBounds(0, 0, 9999, 3264);
                    // ancrage de la caméra sur le joueur
                    this.cameras.main.startFollow(player); 


                    this.anims.create({
                    key: 'virusactif',
                    frames: this.anims.generateFrameNumbers('virus', { start: 0, end: 1 }),
                    frameRate: 10,
                    repeat: -1
                    });

                    var startPoint = new Phaser.Math.Vector2(900, 630);
                    var controlPoint1 = new Phaser.Math.Vector2(1000, 630);
                    var controlPoint2 = new Phaser.Math.Vector2(1250, 630);
                    var endPoint = new Phaser.Math.Vector2(1600, 630);

                    var curve = new Phaser.Curves.CubicBezier(startPoint, controlPoint1, controlPoint2, endPoint);

                    var graphics = this.add.graphics();



                    this.followvirus = this.add.follower(curve, 3700, 2350, 'virus').setInteractive();
                    this.physics.add.existing(this.followvirus);
                    this.followvirus.body.setAllowGravity(false)
                    this.followvirus.anims.play('virusactif', true)
                    var shape = new Phaser.Geom.Circle(96,96,96);
                    this.followvirus.setInteractive(shape, Phaser.Geom.Circle.Contains);
                    this.followvirus.setSize(32, 32);
                    this.physics.add.collider(player, this.followvirus,this.degats,null,this);
                    
                    
                    
                    //Action de la zone d'attaque
                    this.physics.add.collider(this.zoneattack, this.followvirus,this.degatsennemi,null,this);
                    this.physics.add.collider(this.zoneattack, this.ennemivol,this.degatsennemi2,null,this);
                    this.physics.add.collider(this.zoneattack, this.ennemivol2,this.degatsennemi3,null,this);
                    this.physics.add.collider(this.zoneattack, this.ennemiterre,this.degatsennemi4,null,this);
                    

                    this.followvirus.startFollow({
                        duration: 5000,
                        yoyo: true,
                        ease: 'Sine.easeInOut',
                        repeat : -1
                    });

                    this.nuit = this.add.sprite(550, 475, 'nuit').setScrollFactor(0);
                    this.nuit.alpha = 0.8;
                    this.nuit.visible = false;


                    //projecteurs
                    this.projo1 = this.physics.add.sprite(6270,770,"projo");
                    this.projo1.setImmovable();
                    this.projo1.body.setAllowGravity(false);
                    this.projo1.setSize(50, 370);
                    this.projo1.setOffset(30,0);
                    this.projo1.setScale(0.4)
                    this.physics.add.collider(player, this.projo1,this.degats,null,this);

                   

                    this.vuedoki = this.add.sprite(448, 225, 'vuedoki').setScrollFactor(0);
                    this.vuedoki.alpha = 0.8;
                    this.vuedoki.visible = false;


                    this.grpprojo = this.physics.add.group({ immovable: true, allowGravity: false })
                    this.lumiere = this.map.getObjectLayer("projecteurs");
                    this.lumiere.objects.forEach(coord => {
                        this.grpprojo.create(coord.x + 32, coord.y + 79, "projo");
                    });
                    this.grpprojo.getChildren().forEach(function (child) {
                        //child.setOffset(5000,32);
                        child.setSize(50, 370);
                        child.setOffset(32,0);
                        child.setScale(0.8)
                        }, this)


                    this.grpprojohorizon = this.physics.add.group({ immovable: true, allowGravity: false })
                    this.lumierehorizon = this.map.getObjectLayer("projecteurshorizon");
                    this.lumierehorizon.objects.forEach(coord => {
                        this.grpprojohorizon.create(coord.x - 64, coord.y, "projohorizon");
                    });
                    this.grpprojohorizon.getChildren().forEach(function (child) {
                        //child.setOffset(5000,32);
                        child.setSize(370, 50);
                        child.setOffset(32,64);
                        child.setScale(0.7)
                        }, this)

                    this.physics.add.overlap(player, this.grpprojo, this.degats, null, this);
                    this.physics.add.overlap(player, this.grpprojohorizon, this.degats, null, this);

                    
                    this.timedEvent = new Phaser.Time.TimerEvent({ delay: 8000, callback: this.degatschrono, callbackScope: this, loop: true});
                    this.time.addEvent(this.timedEvent);
                

                    
                   
       

            }

            update() {

                    
                    
                    console.log(safe)
                    scoreText.setText(PV)

                    


                    if(this.nacelle1.y >= 2210){
                        this.nacelle1.setVelocityY(-75);
                    }
                    else if (this.nacelle1.y <= 2100){
                        this.nacelle1.setVelocityY(75);
                    }


                    if(this.nacelle2.x >= 5900){
                        this.nacelle2.setVelocityX(-75);
                    }
                    else if (this.nacelle2.x <= 5700){
                        this.nacelle2.setVelocityX(75);
                    }

                    if(this.nacelle3.x >= 7000){
                        this.nacelle3.setVelocityX(-75);
                    }
                    else if (this.nacelle3.x <= 6900){
                        this.nacelle3.setVelocityX(75);
                    }







                    if(this.projo1.x >= 6270){
                        this.projo1.setVelocityX(-75);
                    }
                    else if (this.projo1.x <= 6100){
                        this.projo1.setVelocityX(75);
                    }


                    if(this.ennemiterre.x >= 5450){
                        this.ennemiterre.setVelocityX(-75);
                    }
                    else if (this.ennemiterre.x <= 5300){
                        this.ennemiterre.setVelocityX(75);
                    }

                    if(this.ennemiterre2.x >= 6350){
                        this.ennemiterre2.setVelocityX(-75);
                    }
                    else if (this.ennemiterre2.x <= 6200){
                        this.ennemiterre2.setVelocityX(75);
                    }





                if (keyA.isDown && changecaract == false) {
                    if(safe == true){
                        pologlace = true
                    }
                    
                    setTimeout(() => {
                    changecaract = true
                                }, 170);
                            
                
                }
                else if (keyA.isDown && changecaract == true) {
                    if(safe == true){
                        pologlace = false
                    }
                    this.time.addEvent(this.timedEvent);
                    setTimeout(() => {
                    changecaract = false
                                }, 170);
                            

                }

                if (pologlace == true){
                    player.setGravity(0, -300)
                    this.nuit.visible = true;
                    this.vuedoki.visible = true;
                    this.grpprojo.getChildren().forEach(function (child) {
                        //child.setOffset(5000,32);
                        child.setOffset(32,0);
                    }, this)

                    this.grpprojohorizon.getChildren().forEach(function (child) {
                        //child.setOffset(5000,32);
                        child.setOffset(0,32);
                    }, this)

                    this.grppobscur.getChildren().forEach(function (child) {
                        //child.setOffset(5000,32);
                        child.setOffset(5000,0);
                    }, this)

                    this.grpshine.getChildren().forEach(function (child) {
                        //child.setOffset(5000,32);
                        child.setOffset(0,0);
                    }, this)

                        if (cursors.left.isDown) {
                        player.setVelocityX(-220);
                        player.anims.play("leftg", true);

                        // à droite
                    } else if (cursors.right.isDown) {
                        player.setVelocityX(220);
                        player.anims.play("rightg", true);
                    }
                    // immoobile
                    else {
                        player.setVelocityX(0);
                        player.anims.play("turng");
                    }
                    // en saut (important : blocked doown au lieu de tuoching down)
                    if (cursors.up.isDown && player.body.blocked.down) {
                        player.setVelocityY(-50);
                    }
                    if ((cursors.up.isDown && player.body.blocked.down)){
                            //si touche haut appuyée ET que le perso touche le sol
                            player.setVelocityY(-228); //alors vitesse verticale négative
                    }
                    
                            if (keyZ.isDown && lanceattack == true) {
                            attaque = true
                            lanceattack = false
                            setTimeout(() => {
                                attaque = false
                                this.zoneattack.y = -5000
                                this.zoneattack.x = -5000
                            }, 200);
                            setTimeout(() => {
                                lanceattack = true
                            }, 700);
                        }
                        if (attaque == true) {
                            this.zoneattack.y = player.y - 29
                            this.zoneattack.x = player.x - 29
                        }

                    //changement etat des portes
                    

                    this.portelune.anims.play('portelunefermee', true)
                    this.portelune.setOffset(0,-1000);

                    this.portesoleil.anims.play('portesoleilfermee', true)
                    this.portesoleil.setOffset(0,0);
                    //this.projo1.setOffset(30,0);
                    //this.projo2.setOffset(30,0);
                    
                }
                    else if (pologlace == false){

                        player.setGravity(0, 0)
                        this.grpprojo.getChildren().forEach(function (child) {
                        //child.setOffset(5000,32);
                        child.setOffset(5000,0);
                        }, this)

                        this.grpprojohorizon.getChildren().forEach(function (child) {
                        //child.setOffset(5000,32);
                        child.setOffset(5000,0);
                        }, this)

                        this.nuit.visible = false;
                        this.vuedoki.visible = false;
                        this.grppobscur.getChildren().forEach(function (child) {
                        //child.setOffset(5000,32);
                        child.setOffset(0,0);
                        }, this)

                        this.grpshine.getChildren().forEach(function (child) {
                        //child.setOffset(5000,32);
                        child.setOffset(5000,0);
                        }, this)


                    // a gauche
                        if (cursors.left.isDown) {
                        player.setVelocityX(-400);
                        player.anims.play("left", true);

                        // à droite
                        } else if (cursors.right.isDown) {
                        player.setVelocityX(400);
                        player.anims.play("right", true);
                        }
                        // immoobile
                        else {
                        player.setVelocityX(0);
                        player.anims.play("turn");
                        }
                        //lorsdupremier saut, possibilité de double jump
                        if ((cursors.up.isDown && player.body.blocked.down)){
                            player.setVelocityY(-300);
                            doublejump = 0
                            setTimeout(() => {
                                doublejump = 1
                               
                                }, 300);
                        }
                        //Doublejump effectuer, un seul disponible après utilisation !
                        if ((cursors.up.isDown && doublejump == 1)){
                                    player.setVelocityY(-300);
                                    doublejump = 0
                        }
                        if ((player.body.blocked.down)){
                                    doublejump = 1
                        }


                        if (keyZ.isDown && lanceattack == true) {
                            attaque = true
                            lanceattack = false
                            setTimeout(() => {
                                attaque = false
                                this.zoneattack.y = -5000
                                this.zoneattack.x = -5000
                            }, 200);
                            setTimeout(() => {
                                lanceattack = true
                            }, 700);
                        }
                        if (attaque == true) {
                            this.zoneattack.y = player.y - 29
                            this.zoneattack.x = player.x - 29
                        }







                        
                        //changement etat des portes
                        this.portesoleil.anims.play('portesoleilouverte', true)
                        this.portesoleil.setOffset(0,-1000);
                        

                        this.portelune.anims.play('porteluneouverte', true)
                        this.portelune.setOffset(0,0);
                        //this.projo1.setOffset(-5000,0);
                        //this.projo2.setOffset(-5000,0);
                        
                        if(repousseright == true){
                            
                            console.log("repousser !")
                        }
                        
                        
                    }
                

                    player.body.setAllowGravity(true)
                if (gameOver){return;}

                



                        



                
            }

                

                degats() {
                

                    if (PV >= 1 && tempsdegats == false){
                        tempsdegats = true
                        cursors.right.reset();
                        cursors.left.reset();
                        cursors.up.reset();
                        cursors.down.reset();
                        repousseright = true
                        player.alpha = 0.5
                        player.setVelocityY(-60)
                        player.setVelocityX(-300)
                        this.serolReset = this.time.addEvent({
                        delay: 4000,
                        callback: ()=>{
                            tempsdegats = false
                            player.alpha = 1;
                            PV = 0;
                        },
                        loop: false
                        })
                    this.serolReset = this.time.addEvent({
                        delay: 500,
                        callback: ()=>{
                            repousseright = false
                            cursors.right.enabled = true;
                            cursors.left.enabled = true;
                            cursors.up.enabled = true;
                            cursors.down.enabled = true;
                        },
                        loop: false
                    })
                    console.log("aie")
                    }
                   
                    

                    if (PV == 0 && tempsdegats == false){
                        this.physics.pause();
                        player.setTint(0xff0000);
                        player.anims.play('turn');
                        gameOver = true;
                        console.log("aie2")
                    }
                    
                
                }



                degatschrono() {
                

                if (PV >= 1 && pologlace == false){
                    cursors.right.reset();
                    cursors.left.reset();
                    cursors.up.reset();
                    cursors.down.reset();
                    cursors.right.enabled = false;
                    cursors.left.enabled = false;
                    cursors.up.enabled = false;
                    cursors.down.enabled = false;
                    player.setVelocityY(0)
                    player.setVelocityX(0)
                    repousseright = true
                    player.alpha = 0.5
                    this.serolReset = this.time.addEvent({
                    delay: 4000,
                    callback: ()=>{
                        player.alpha = 1;
                        PV = 0;
                    },
                    loop: false
                    })
                this.serolReset = this.time.addEvent({
                    delay: 1700,
                    callback: ()=>{
                        repousseright = false
                        cursors.right.enabled = true;
                        cursors.left.enabled = true;
                        cursors.up.enabled = true;
                        cursors.down.enabled = true;
                    },
                    loop: false
                })
                console.log("aie")
                }
               
                

                if (PV == 0 && pologlace == false){
                    this.physics.pause();
                    player.setTint(0xff0000);
                    player.anims.play('turn');
                    gameOver = true;
                    console.log("aie2")
                }
                
            
            }




                degatsennemi() {
                    this.followvirus.destroy()
                }
                degatsennemi2() {
                    this.ennemivol.destroy()
                }
                degatsennemi3() {
                    this.ennemivol2.destroy()
                }
                degatsennemi4() {
                    this.ennemiterre.destroy()
                }

                degatsennemi5() {
                    this.ennemiterre2.destroy()
                }


                ennemitombe() {
                    this.hitbox.destroy()
                    this.ennemivol.body.setAllowGravity(true)
            
                }

                ennemitombe2() {
                    this.hitbox2.destroy()
                    this.ennemivol2.body.setAllowGravity(true)
            
                }

                switch() {
                    safe = true
                    setTimeout(() => {
                    safe = false
                                }, 90);
                    
            
                }


                collectpop(player, pop){
                PV += 1; //augmente le score de 1
                this.popcorn.destroy() // l’étoile disparaît
                pop.destroy()
                }


                bumper1() {
                    this.chaise1.anims.play('chaise', true)
                    if(pologlace== false){
                        player.setVelocityY(-600)
                    }
                    if(pologlace == true){
                        player.setVelocityY(-400)
                    }
                    
                
            
                }

                bumper2() {
                    this.chaise2.anims.play('chaise', true)
                    if(pologlace== false){
                        player.setVelocityY(-600)
                    }
                    if(pologlace == true){
                        player.setVelocityY(-400)
                    }
                    
                
            
                }

                bumper3() {
                    this.chaise3.anims.play('chaise', true)
                    if(pologlace== false){
                        player.setVelocityY(-475)
                    }
                    if(pologlace == true){
                        player.setVelocityY(-350)
                    }
                    
                
            
                }

                bumper4() {
                    this.chaise4.anims.play('chaise', true)
                    if(pologlace== false){
                        player.setVelocityY(-550)
                    }
                    if(pologlace == true){
                        player.setVelocityY(-380)
                    }
                   
                
            
                }

                bumper5() {
                    this.chaise5.anims.play('chaise', true)
                    if(pologlace== false){
                        player.setVelocityY(-550)
                    }
                    if(pologlace == true){
                        player.setVelocityY(-380)
                    }
                   
                
            
                }

                bumper6() {
                    this.chaise6.anims.play('chaise', true)
                    if(pologlace== false){
                        player.setVelocityY(-550)
                    }
                    if(pologlace == true){
                        player.setVelocityY(-380)
                    }
                   
                
            
                }

                bumper7() {
                    this.chaise7.anims.play('chaise', true)
                    if(pologlace== false){
                        player.setVelocityY(-550)
                    }
                    if(pologlace == true){
                        player.setVelocityY(-380)
                    }
                   
                
            
                }


                escalade() {
                    if (pologlace == true){
                        player.body.setAllowGravity(false)
                        player.setVelocityX(0);
                        player.setVelocityY(0);
                        if (cursors.up.isDown) {
                        player.setVelocityY(-100);
                        }
                        if ((cursors.down.isDown)){
                                //si touche haut appuyée ET que le perso touche le sol
                                player.setVelocityY(100); //alors vitesse verticale négative
                        }

                    }
            
                }

            }





           





        var config = {
            type: Phaser.AUTO,
            width: 896, height: 448,
            physics: {
                default: 'arcade',
                arcade: {
                    gravity: { y: 650 },
                    debug: true
                }
            },

            scene: [Studio,test]
        };

        const Game = new Phaser.Game(config);




        gameOver = false;
        score = 0;




























    </script>
</body>

</html>